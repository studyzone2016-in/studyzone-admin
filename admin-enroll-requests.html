<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Study ZONE | Enrollment Requests</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- PapaParse CSV Parser (handles multi-line & commas) -->
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<style>
body {
  font-family: "Segoe UI", Arial, sans-serif;
  background: #f5f9ff;
  margin: 0;
  padding: 20px;
}

h1 {
  text-align: center;
  color: #1f3c88;
  margin-bottom: 10px;
}

.subtext {
  text-align: center;
  font-size: 13px;
  color: #555;
}

table {
  width: 100%;
  border-collapse: collapse;
  background: #fff;
  margin-top: 20px;
}

th, td {
  border: 1px solid #ddd;
  padding: 10px;
  text-align: left;
  font-size: 14px;
  vertical-align: top;
  white-space: pre-wrap; /* ðŸ”‘ keeps multi-line text */
}

th {
  background: #1f3c88;
  color: #fff;
  position: sticky;
  top: 0;
}

tr:nth-child(even) {
  background: #f2f6ff;
}

.footer {
  margin-top: 15px;
  text-align: center;
  font-size: 12px;
  color: #555;
}
</style>
</head>

<body>

<h1>Study ZONE â€“ Enrollment Requests</h1>
<div class="subtext">Auto-loaded from Google Sheets (Read Only)</div>

<table>
  <thead>
    <tr id="tableHeader"></tr>
  </thead>
  <tbody id="tableBody"></tbody>
</table>

<div class="footer">
  For internal admin use only
</div>

<script>
/* ðŸ”´ YOUR PUBLISHED CSV LINK */
const csvUrl =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vSC3P-2fO5c0kdG-rE4A9d3V54wNwH4CH6q6kM_eUqjTMr4P228wCmYZr4MtP6UN7BBoyQcWw4kc1Sy/pub?gid=0&single=true&output=csv";

Papa.parse(csvUrl, {
  download: true,
  skipEmptyLines: true,
  complete: function(results) {

    const data = results.data;
    if (!data || data.length === 0) {
      alert("No enrollment data found");
      return;
    }

    const headerRow = data[0];
    const dataRows = data.slice(1).reverse(); // Latest first

    // Create headers
    headerRow.forEach(header => {
      const th = document.createElement("th");
      th.textContent = header;
      document.getElementById("tableHeader").appendChild(th);
    });

    // Create rows
    dataRows.forEach(row => {
      if (row.length === 0) return;

      const tr = document.createElement("tr");

      row.forEach(cell => {
        const td = document.createElement("td");
        td.textContent = cell || "";
        tr.appendChild(td);
      });

      document.getElementById("tableBody").appendChild(tr);
    });
  },
  error: function(error) {
    alert("Unable to load enrollment data");
    console.error(error);
  }
});
</script>

</body>
</html>