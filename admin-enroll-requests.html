<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Study ZONE | Enrollment Requests</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<style>
body {
  font-family: "Segoe UI", Arial, sans-serif;
  background: #f5f9ff;
  margin: 0;
  padding: 20px;
}

h1 {
  text-align: center;
  color: #1f3c88;
}

.subtext {
  text-align: center;
  font-size: 13px;
  color: #555;
}

table {
  width: 100%;
  border-collapse: collapse;
  background: #fff;
  margin-top: 20px;
}

th, td {
  border: 1px solid #ddd;
  padding: 10px;
  font-size: 14px;
  vertical-align: top;
  white-space: pre-wrap;
}

th {
  background: #1f3c88;
  color: #fff;
  position: sticky;
  top: 0;
}

tr:nth-child(even) {
  background: #f2f6ff;
}

.footer {
  margin-top: 15px;
  text-align: center;
  font-size: 12px;
  color: #555;
}
</style>
</head>

<body>

<h1>Study ZONE â€“ Enrollment Requests</h1>
<div class="subtext">Auto-loaded from Google Sheets (Read Only)</div>

<table>
  <thead>
    <tr id="tableHeader"></tr>
  </thead>
  <tbody id="tableBody"></tbody>
</table>

<div class="footer">For internal admin use only</div>

<script>
/* Session check */
if (sessionStorage.getItem("adminAuth") !== "true") {
  alert("Unauthorized Access");
  window.location.href = "index.html";
}

/* CSV Load */
const csvUrl =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vSC3P-2fO5c0kdG-rE4A9d3V54wNwH4CH6q6kM_eUqjTMr4P228wCmYZr4MtP6UN7BBoyQcWw4kc1Sy/pub?gid=0&single=true&output=csv";

Papa.parse(csvUrl, {
  download: true,
  skipEmptyLines: true,
  complete: function(results) {
    const data = results.data;
    const headerRow = data[0];
    const rows = data.slice(1).reverse();

    headerRow.forEach(h => {
      const th = document.createElement("th");
      th.textContent = h;
      tableHeader.appendChild(th);
    });

    rows.forEach(r => {
      const tr = document.createElement("tr");
      r.forEach(c => {
        const td = document.createElement("td");
        td.textContent = c || "";
        tr.appendChild(td);
      });
      tableBody.appendChild(tr);
    });
  }
});
</script>

</body>
</html>