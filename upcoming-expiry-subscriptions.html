<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Study ZONE | Upcoming Expiry Subscriptions</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f5f7fa;
  margin: 0;
  padding: 16px;
}

.top-bar { margin-bottom: 16px; }

.back-btn {
  background: #0d6efd;
  color: #fff;
  border: none;
  padding: 8px 14px;
  border-radius: 6px;
}

h2 { color: #333; }

.table-container {
  overflow-x: auto;
  background: #fff;
  border-radius: 8px;
}

table {
  width: 100%;
  min-width: 700px;
  border-collapse: collapse;
}

th, td {
  padding: 10px;
  border-bottom: 1px solid #e5e7eb;
}

thead {
  background: #1f2937;
  color: #fff;
}

.expiry {
  color: #dc2626;
  font-weight: 600;
}
</style>
</head>

<body>

<div class="top-bar">
  <button class="back-btn" onclick="location.href='index.html'">‚Üê Back</button>
</div>

<h2>Upcoming Expiry Subscriptions</h2>

<div class="table-container">
<table>
<thead>
<tr>
<th>Access Expiry</th>
<th>Center</th>
<th>Full Name</th>
<th>Plan</th>
<th>Phone</th>
</tr>
</thead>
<tbody id="tableBody">
<tr><td colspan="5">Loading...</td></tr>
</tbody>
</table>
</div>

<script>
if (sessionStorage.getItem("adminAuth") !== "true") {
  alert("Unauthorized Access");
  location.href = "index.html";
}

Papa.parse(
"https://docs.google.com/spreadsheets/d/e/2PACX-1vQosG1886lb-AuGEol8xxZDg86byv_mYktRIpTU9F9iCQPH4GSkY_xwX5WAYZBLiBDZuUO67pidUvEr/pub?gid=2082915008&single=true&output=csv",
{
  download: true,
  header: true,
  complete: res => {
    tableBody.innerHTML = "";
    res.data.forEach(r => {
      tableBody.innerHTML += `
        <tr>
          <td class="expiry">${r["Access Expiry (DD-MM-YY)"]||"--"}</td>
          <td>${r["Center"]||"--"}</td>
          <td>${r["Full Name"]||"--"}</td>
          <td>${r["Plan"]||"--"}</td>
          <td>${r["Phone"]||"--"}</td>
        </tr>`;
    });
  }
});
</script>

</body>
</html>